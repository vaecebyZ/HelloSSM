<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="io.github.vaecebyz.dao.IUserDao">

    <!--    配置查询结果的列名和实体对象映射-->
    <resultMap id="userMap" type="io.github.vaecebyz.domain.User">

        <!--主键对应   来自类    来自数据库-->
        <id property="id" column="id"></id>
        <!--        严格区分大小写            windows下不用区分-->
        <result property="nickname" column="nickname"></result>
        <result property="avatar" column="avatar"></result>
        <result property="address" column="address"></result>
        <result property="info" column="info"></result>
        <result property="gender" column="gender"></result>

    </resultMap>

    <!--    配置查询所有-->
    <select id="findAll" resultMap="userMap">

        select * from people

    </select>

    <!--    查询一个-->
    <select id="findOne" parameterType="io.github.vaecebyz.domain.User" resultType="io.github.vaecebyz.domain.User">

        select  * from people where nickname = #{nickname}

    </select>
    <!--模糊查询-->
    <select id="findOneByName" parameterType="java.lang.String" resultType="io.github.vaecebyz.domain.User">

    select * from people where nickname like '%${value}%'

    </select>

    <!--    保存用户-->
    <insert id="saveUser" parameterType="io.github.vaecebyz.domain.User">
        -- 插入操作后返回ID
        -- 对应实体类 对应数据库列表 返回结果集类型 执行的时间
        <selectKey keyProperty="id" keyColumn="id" resultType="java.lang.Integer" order="AFTER">

            select last_insert_id();

        </selectKey>

        insert into people(nickname,avatar,gender,address,info)
        values(#{nickname},#{avatar},#{gender},#{address},#{info});

    </insert>
    <!--更新用户-->
    <update id="updateUser" parameterType="io.github.vaecebyz.domain.User">

        update  people set nickname=#{nickname},avatar=#{avatar},gender=#{gender},address=#{address},info=#{info} where id = #{id};

    </update>

    <!--删除用户-->
    <delete id="delUser" parameterType="io.github.vaecebyz.domain.User">

        delete from people where id = #{id}

    </delete>

</mapper>